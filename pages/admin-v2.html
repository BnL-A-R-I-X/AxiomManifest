<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="USS Axiom Administrative Control Panel - Unified management interface for commission systems, data operations, and ship maintenance.">
    <title>USS Axiom // Administrative Control</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/commission-admin-v2.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto&display=swap" rel="stylesheet">
</head>
<body>

<!-- Security Access Screen -->
<div id="security-screen" class="security-overlay">
  <div class="security-panel">
    <div class="security-header">
      <img src="../assets/logos/axiom.png" alt="BNL Logo" class="security-logo">
      <h1>üîí BNL SECURITY CHECKPOINT</h1>
      <p class="security-warning">ADMINISTRATIVE TERMINAL ACCESS</p>
      <p class="security-subtitle">Level 7 Clearance Required</p>
    </div>
    
    <div class="access-form">
      <label for="pincode" class="pin-label">Enter Security Code:</label>
      <input type="password" id="pincode" class="pin-input" maxlength="4" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
      <button id="access-btn" class="access-button">GRANT ACCESS</button>
      <button id="cancel-btn" class="cancel-button">CANCEL</button>
    </div>
    
    <div class="security-notice">
      <p>‚ö†Ô∏è UNAUTHORIZED ACCESS ATTEMPT WILL BE LOGGED</p>
      <p>BNL Security Protocol 3272-X Active</p>
    </div>
  </div>
</div>

<!-- Main Content (Hidden by default) -->
<div id="main-content" class="hidden">

<header class="site-header">
    <div class="header-inner">
        <img src="../assets/logos/axiom.png" alt="BNL Axiom Logo" class="bnl-logo small-centered" title="Buy n Large Corporation ‚Äî Property of USS Axiom">
        <div>
            <h1>üîí USS AXIOM // ADMINISTRATIVE CONTROL</h1>
            <p class="subtext">Unified System & Commission Management</p>
            <p class="status">STATUS: SECURED ‚Äî CLEARANCE: <strong>LEVEL 7 (ADMIN)</strong> ‚Äî USER: <strong>A.R.I.E.L.L.A</strong></p>
            <div class="status-widgets">
                SHIP TIME: <strong id="shipTime"></strong> |
                SECTOR: <strong>BNL-7 / ALPHA</strong> |
                UPLINK: <strong>ENCRYPTED</strong>
            </div>
        </div>
    </div>
</header>

<nav class="nav-bar nav-right">
    <a href="../index.html" class="nav-btn">HOME</a>
    
    <div class="nav-dropdown">
        <div class="nav-btn nav-dropdown-toggle">ARCHIVES</div>
        <div class="nav-dropdown-menu">
            <div class="nav-dropdown-header">BNL Archives</div>
            <a href="ocs.html" class="nav-dropdown-item">OC Database</a>
            <a href="#" class="nav-dropdown-item disabled coming-soon">Character Rankings [MAINTENANCE]</a>
            <a href="upcoming-commissions-v2.html" class="nav-dropdown-item">Commission Queue</a>
        </div>
    </div>
    
    <div class="nav-dropdown">
        <div class="nav-btn nav-dropdown-toggle">PROFILE</div>
        <div class="nav-dropdown-menu">
            <div class="nav-dropdown-header">üë§ User Profile</div>
            <a href="bio.html" class="nav-dropdown-item">Biography</a>
            <a href="socials.html" class="nav-dropdown-item">Social Links</a>
        </div>
    </div>
    
    <div class="nav-dropdown">
        <div class="nav-btn nav-dropdown-toggle">COMMUNITY</div>
        <div class="nav-dropdown-menu">
            <div class="nav-dropdown-header">Community Hub</div>
            <a href="#" class="nav-dropdown-item disabled coming-soon">Art Gallery</a>
            <a href="#" class="nav-dropdown-item disabled coming-soon">User Submissions</a>
            <a href="#" class="nav-dropdown-item disabled coming-soon">Featured Works</a>
        </div>
    </div>
    
    <div class="nav-dropdown">
        <div class="nav-btn nav-dropdown-toggle secret-btn current">ADMIN</div>
        <div class="nav-dropdown-menu">
            <div class="nav-dropdown-header">üîß Admin Panel</div>
            <a href="admin-v2.html" class="nav-dropdown-item active">Administrative Control</a>
        </div>
    </div>
</nav>

<section class="terminal-intro">
    <p>
        <strong>ADMINISTRATIVE CONTROL:</strong> Unified management interface for commission systems, data operations, and ship maintenance. 
        All actions are logged and monitored per BNL Security Protocol 3272-X.
        <em>Unauthorized access attempts will result in immediate lockdown and security team notification.</em>
    </p>
</section>

<main class="admin-container">
    
    <!-- Commission Statistics Dashboard -->
    <section class="stats-section">
        <h2>üìä Commission Statistics</h2>
        <div class="stats-controls" style="margin-bottom: 1rem; display: flex; gap: 0.5rem;">
            <button id="refresh-data" class="admin-btn" style="background: #4CAF50; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer;">
                üîÑ Refresh Data
            </button>
            <button id="debug-system" class="admin-btn" style="background: #2196F3; color: white; border: none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer;">
                üîç Debug System
            </button>
        </div>
        <div id="commission-stats" class="stats-grid">
            <!-- Stats will be populated by JavaScript -->
        </div>
    </section>

    <!-- Commission Management Section -->
    <section class="commission-section">
        <h2>üé® Commission Management</h2>
        
        <!-- Add New Commission Form -->
        <div class="commission-form-container">
            <h3>Add New Commission</h3>
            <form id="commission-form-v2" class="commission-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="title">Commission Title:</label>
                        <input type="text" id="title" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="artist">Artist:</label>
                        <input type="text" id="artist" name="artist" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="dateCommissioned">Date Commissioned:</label>
                        <input type="date" id="dateCommissioned" name="dateCommissioned">
                    </div>
                    <div class="form-group">
                        <label for="cost">Cost:</label>
                        <input type="text" id="cost" name="cost" placeholder="$0.00">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="character">Primary Character:</label>
                        <input type="text" id="character" name="character">
                    </div>
                    <div class="form-group">
                        <label for="additionalCharacters">Additional Characters:</label>
                        <input type="text" id="additionalCharacters" name="additionalCharacters" placeholder="Optional">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="type">Type:</label>
                        <select id="type" name="type" required>
                            <option value="">Select Type</option>
                            <option value="Character Design">Character Design</option>
                            <option value="Portrait">Portrait</option>
                            <option value="Full Body">Full Body</option>
                            <option value="Scene">Scene</option>
                            <option value="Reference Sheet">Reference Sheet</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="status">Status:</label>
                        <select id="status" name="status" required>
                            <option value="planning">Planning</option>
                            <option value="in-progress">In Progress</option>
                            <option value="review">Review</option>
                            <option value="completed">Completed</option>
                            <option value="on-hold">On Hold</option>
                        </select>
                    </div>
                </div>

                <div class="form-group full-width">
                    <label for="description">Description:</label>
                    <textarea id="description" name="description" rows="4" placeholder="Detailed description of the commission..."></textarea>
                </div>

                <div class="form-group full-width">
                    <label for="notes">Notes:</label>
                    <textarea id="notes" name="notes" rows="2" placeholder="Additional notes or special instructions..."></textarea>
                </div>

                <div class="form-group full-width">
                    <label for="ideaImage">Reference Image (Optional):</label>
                    <input type="file" id="ideaImage" name="ideaImage" accept="image/*">
                    <small>Max file size: 5MB. Supported formats: JPG, PNG, GIF, WebP</small>
                    <div id="image-preview" class="image-preview-container" style="display: none;">
                        <img id="preview-img" src="" alt="Preview">
                        <button type="button" id="remove-image" class="remove-image-btn">Remove Image</button>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="isPublic" name="isPublic" checked>
                            <span class="checkmark"></span>
                            Public (visible on commission queue)
                        </label>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="submit" class="submit-btn">Add Commission</button>
                    <button type="button" id="clear-form" class="clear-btn">Clear Form</button>
                </div>
            </form>
        </div>

        <!-- Commission List Controls -->
        <div class="commission-controls">
            <div class="search-filter-row">
                <div class="search-group">
                    <label for="search-commissions">Search:</label>
                    <input type="text" id="search-commissions" placeholder="Search commissions...">
                </div>
                <div class="filter-group">
                    <label for="filter-status">Filter by Status:</label>
                    <select id="filter-status">
                        <option value="all">All Statuses</option>
                        <option value="planning">Planning</option>
                        <option value="in-progress">In Progress</option>
                        <option value="review">Review</option>
                        <option value="completed">Completed</option>
                        <option value="on-hold">On Hold</option>
                    </select>
                </div>
                <div class="action-group">
                    <button id="export-commissions" class="action-btn">üìÅ Export</button>
                    <button id="import-commissions" class="action-btn">üìÇ Import</button>
                </div>
            </div>
        </div>

        <!-- Commission List -->
        <div id="commissions-list" class="commission-list">
            <!-- Commissions will be rendered here -->
        </div>
    </section>

    <!-- Data Management Section -->
    <section class="admin-section">
        <h2>üìä Data Management</h2>
        <div class="admin-tools">
            <div class="tool-group">
                <h3>Commission System</h3>
                <button id="export-commissions-2" class="admin-btn">
                    üìÅ Export Commission Data
                </button>
                <button id="import-commissions-2" class="admin-btn">
                    üìÇ Import Commission Data
                </button>
                <button id="force-load-data" class="admin-btn load-data">
                    üîÑ Force Load Database
                </button>
                <div class="tool-info">
                    <p><strong>Storage:</strong> Firebase cloud database</p>
                    <p><strong>Collection:</strong> Firestore 'commissions'</p>
                    <p><strong>Format:</strong> JSON export with timestamp</p>
                    <p><strong>Load Data:</strong> Forces refresh of commission data from Firebase</p>
                </div>
            </div>

            <div class="tool-group">
                <h3>üé® Future Artists</h3>
                <button onclick="showFutureArtistForm()" class="admin-btn">
                    ‚ûï Add Future Artist
                </button>
                <button onclick="viewFutureArtists()" class="admin-btn">
                    üëÅÔ∏è View Artists List
                </button>
                <button onclick="exportFutureArtists()" class="admin-btn">
                    üìÅ Export Artists
                </button>
                <div class="tool-info">
                    <p><strong>Future Artists:</strong> Manage list of artists you want to commission</p>
                    <p><strong>Display:</strong> Shows as table on commission queue page</p>
                    <p><strong>Storage:</strong> Firebase 'futureArtists' collection</p>
                </div>
            </div>
            
            <div class="tool-group">
                <h3>Character Rankings System</h3>
                <button id="export-rankings" class="admin-btn">
                    üìä Download Rankings Data
                </button>
                <button id="clear-rankings" class="admin-btn danger">
                    üóëÔ∏è Clear All Rankings
                </button>
                <div class="tool-info">
                    <p><strong>Storage:</strong> Local browser data management</p>
                    <p><strong>Format:</strong> JSON export with timestamp</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Security & Access Reference -->
    <section class="admin-section password-section">
        <h2>üîê Security Access Reference</h2>
        <div class="password-grid">
            <div class="password-card commission-access">
                <div class="password-header">
                    <h3>üé® Commission Ideas Access</h3>
                    <span class="access-level">UNLOCKED</span>
                </div>
                <div class="password-display">
                    <span class="password-label">Password:</span>
                    <span class="password-value">UNLOCKED</span>
                    <button class="copy-btn" data-copy="UNLOCKED">üìã</button>
                </div>
                <p class="password-description">Commission Ideas section is now permanently unlocked and accessible to all users.</p>
            </div>
            
            <div class="password-card admin-access">
                <div class="password-header">
                    <h3>üîí Administrative Control</h3>
                    <span class="access-level">ADMIN TIER</span>
                </div>
                <div class="password-display">
                    <span class="password-label">Security PIN:</span>
                    <span class="password-value">3272</span>
                    <button class="copy-btn" data-copy="3272">üìã</button>
                </div>
                <p class="password-description">Main administrative interface PIN for managing commissions and system data.</p>
            </div>
        </div>
    </section>

</main>

<section class="system-footer">
    <p>¬© 2025 Ariella Fawnbrook // USS Axiom Administrative Control</p>
    <p>BNL / AXIOM ADMIN INTERFACE ‚Äî VERSION 4.0</p>
</section>

<div class="status-ticker">
    <marquee behavior="scroll" direction="left">
        ADMIN ACCESS: Administrative control active. ‚Äî SECURITY LEVEL: MAXIMUM ‚Äî All actions are monitored and logged ‚Äî COMMISSION SYSTEM: OPERATIONAL ‚Äî DATA MANAGEMENT: ACTIVE
    </marquee>
</div>

</div>

<!-- Future Artist Form Modal -->
<div id="future-artist-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
        <div class="modal-header">
            <h2>üé® Add Future Artist</h2>
            <button onclick="hideFutureArtistForm()" class="modal-close">‚úï</button>
        </div>
        
        <form id="future-artist-form" class="commission-form">
            <div class="form-grid">
                <div class="form-group">
                    <label for="artist-name">Artist Name *</label>
                    <input type="text" id="artist-name" name="artistName" required placeholder="Artist's name or handle">
                </div>
                
                <div class="form-group">
                    <label for="artist-platform">Platform</label>
                    <select id="artist-platform" name="platform">
                        <option value="Twitter">Twitter</option>
                        <option value="Instagram">Instagram</option>
                        <option value="DeviantArt">DeviantArt</option>
                        <option value="ArtStation">ArtStation</option>
                        <option value="Discord">Discord</option>
                        <option value="Telegram">Telegram</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="artist-handle">Handle/Username</label>
                    <input type="text" id="artist-handle" name="handle" placeholder="@username or handle">
                </div>
                
                <div class="form-group">
                    <label for="artist-website">Website/Portfolio</label>
                    <input type="url" id="artist-website" name="website" placeholder="https://artist-portfolio.com">
                </div>
                
                <div class="form-group">
                    <label for="artist-style">Art Style</label>
                    <input type="text" id="artist-style" name="style" placeholder="e.g., Anime, Realistic, Cartoon">
                </div>
                
                <div class="form-group">
                    <label for="commission-type-interest">Commission Type Interest</label>
                    <select id="commission-type-interest" name="commissionType">
                        <option value="Character Portrait">Character Portrait</option>
                        <option value="Full Body">Full Body</option>
                        <option value="Reference Sheet">Reference Sheet</option>
                        <option value="Scene Art">Scene Art</option>
                        <option value="Multiple Characters">Multiple Characters</option>
                        <option value="NSFW">NSFW</option>
                        <option value="SFW Only">SFW Only</option>
                        <option value="Any">Any Type</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="estimated-cost">Estimated Cost Range</label>
                    <input type="text" id="estimated-cost" name="estimatedCost" placeholder="e.g., $50-$150">
                </div>
                
                <div class="form-group">
                    <label for="artist-priority">Priority Level</label>
                    <select id="artist-priority" name="priority">
                        <option value="high">üî• High Priority</option>
                        <option value="medium" selected>‚≠ê Medium Priority</option>
                        <option value="low">üìã Low Priority</option>
                        <option value="someday">üí§ Someday</option>
                    </select>
                </div>
                
                <div class="form-group full-width">
                    <label for="artist-notes">Notes</label>
                    <textarea id="artist-notes" name="notes" rows="3" placeholder="Additional notes about this artist or commission ideas..."></textarea>
                </div>
                
                <div class="form-group">
                    <label for="commission-status">Status</label>
                    <select id="commission-status" name="status">
                        <option value="researching">üîç Researching</option>
                        <option value="planning" selected>üìã Planning</option>
                        <option value="ready">‚úÖ Ready to Commission</option>
                        <option value="contacted">üìß Contacted</option>
                        <option value="commissioned">üé® Commissioned</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="artist-public" name="isPublic" checked>
                        <span class="checkmark"></span>
                        Show on public queue page
                    </label>
                </div>
            </div>
            
            <div class="form-actions">
                <button type="submit" class="submit-btn">üíæ Add Artist</button>
                <button type="button" onclick="hideFutureArtistForm()" class="clear-btn">‚ùå Cancel</button>
            </div>
        </form>
    </div>
</div>

<!-- Future Artists List Modal -->
<div id="future-artists-list-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content large-modal">
        <div class="modal-header">
            <h2>üé® Future Artists List</h2>
            <button onclick="hideFutureArtistsList()" class="modal-close">‚úï</button>
        </div>
        
        <div class="modal-body">
            <div id="future-artists-container">
                <!-- Artists list will be populated here -->
            </div>
        </div>
    </div>
</div>

<script>
// Initialize Firebase Commission System
let commissionSystemV2;

// Security PIN system
document.addEventListener('DOMContentLoaded', function() {
    console.log('üîß Admin page DOM loaded, initializing systems...');
    
    // Initialize Firebase commission system as commissionSystemV2 for compatibility
    function initializeCommissionSystem() {
        if (window.FirebaseCommissionSystem) {
            console.log('üî• FirebaseCommissionSystem found, initializing...');
            commissionSystemV2 = new window.FirebaseCommissionSystem();
            window.commissionSystemV2 = commissionSystemV2;
            console.log('üî• Firebase commission system initialized for admin');
            
            // Wait for Firebase to actually be ready and load data
            const waitForFirebase = setInterval(() => {
                if (commissionSystemV2.firebaseReady) {
                    console.log('üî• Firebase is ready, checking for data...');
                    
                    // Force load commissions
                    commissionSystemV2.loadCommissions().then(() => {
                        console.log('üìä Commission data loaded, count:', commissionSystemV2.getAllCommissions().length);
                        
                        // Now initialize admin interface
                        if (window.CommissionAdminV2) {
                            clearInterval(waitForFirebase);
                            window.commissionAdminV2 = new window.CommissionAdminV2();
                            console.log('üîß Commission Admin V2 interface initialized');
                            
                            // Force initial render after a short delay to ensure everything is loaded
                            setTimeout(() => {
                                if (window.commissionAdminV2) {
                                    console.log('ÔøΩ Forcing initial render...');
                                    window.commissionAdminV2.renderCommissions();
                                    window.commissionAdminV2.updateStats();
                                }
                            }, 500);
                        } else {
                            console.warn('‚ö†Ô∏è CommissionAdminV2 class not found');
                        }
                    }).catch(error => {
                        console.error('‚ùå Error loading commission data:', error);
                    });
                } else {
                    console.log('‚è≥ Waiting for Firebase to be ready...');
                }
            }, 500);
        } else {
            console.warn('‚ö†Ô∏è FirebaseCommissionSystem not found, retrying...');
            // Wait for Firebase to load
            setTimeout(initializeCommissionSystem, 500);
        }
    }
    
    // Start initialization
    initializeCommissionSystem();
    
    const pinInput = document.getElementById('pincode');
    const accessBtn = document.getElementById('access-btn');
    const cancelBtn = document.getElementById('cancel-btn');
    const securityScreen = document.getElementById('security-screen');
    const mainContent = document.getElementById('main-content');
    
    const correctPin = '3272'; // BNL Security Protocol 3272-X
    
    function checkAccess() {
        const enteredPin = pinInput.value;
        if (enteredPin === correctPin) {
            securityScreen.classList.add('hidden');
            mainContent.classList.remove('hidden');
            
            // Initialize ship time
            if (typeof initializeShipTime === 'function') {
                initializeShipTime();
            }
        } else {
            pinInput.style.borderColor = '#f44336';
            pinInput.style.animation = 'shake 0.5s';
            setTimeout(() => {
                pinInput.style.borderColor = '';
                pinInput.style.animation = '';
                pinInput.value = '';
            }, 500);
        }
    }
    
    function cancelAccess() {
        window.location.href = '../index.html';
    }
    
    accessBtn.addEventListener('click', checkAccess);
    cancelBtn.addEventListener('click', cancelAccess);
    
    pinInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            checkAccess();
        }
    });
    
    // Auto-focus pin input
    pinInput.focus();
    
    // Add confirmation dialog after admin system is loaded
    function addConfirmationDialog() {
        const commissionForm = document.getElementById('commission-form-v2');
        if (commissionForm && window.commissionAdminV2) {
            // Store the original handleFormSubmit method
            const originalHandleFormSubmit = window.commissionAdminV2.handleFormSubmit.bind(window.commissionAdminV2);
            
            // Override the handleFormSubmit method to add confirmation
            window.commissionAdminV2.handleFormSubmit = function(e) {
                // Get form data for preview
                const formData = new FormData(e.target);
                const title = formData.get('title') || 'Untitled';
                const artist = formData.get('artist') || 'Unknown Artist';
                const cost = formData.get('cost') || '$0.00';
                const status = formData.get('status') || 'planning';
                
                // Create confirmation message
                const confirmMessage = `Are you sure you want to add this commission?\n\n` +
                                     `Title: ${title}\n` +
                                     `Artist: ${artist}\n` +
                                     `Cost: ${cost}\n` +
                                     `Status: ${status}\n\n` +
                                     `This will be saved to the Firebase database.`;
                
                // Show confirmation dialog
                if (!confirm(confirmMessage)) {
                    e.preventDefault();
                    return false;
                }
                
                // If confirmed, call the original handler
                return originalHandleFormSubmit(e);
            };
            
            console.log('‚úÖ Confirmation dialog added to commission form');
        } else {
            // Retry after a short delay
            setTimeout(addConfirmationDialog, 100);
        }
    }
    
    // Start trying to add confirmation dialog
    addConfirmationDialog();
    
    // Add force load data button functionality
    const loadDataBtn = document.getElementById('force-load-data');
    if (loadDataBtn) {
        loadDataBtn.addEventListener('click', forceLoadData);
        console.log('‚úÖ Added listener for force-load-data');
    }
    
    // Add refresh data button functionality
    const refreshDataBtn = document.getElementById('refresh-data');
    if (refreshDataBtn) {
        refreshDataBtn.addEventListener('click', refreshData);
        console.log('‚úÖ Added listener for refresh-data');
    }
    
    // Add debug system button functionality
    const debugSystemBtn = document.getElementById('debug-system');
    if (debugSystemBtn) {
        debugSystemBtn.addEventListener('click', debugSystem);
        console.log('‚úÖ Added listener for debug-system');
    }
    
    function forceLoadData() {
        if (window.commissionSystemV2) {
            try {
                console.log('üîÑ Force loading commission data...');
                
                // Show loading indicator
                const button = document.getElementById('force-load-data');
                const originalText = button.innerHTML;
                button.innerHTML = '‚è≥ Loading...';
                button.disabled = true;
                
                // Force reload data from Firebase
                window.commissionSystemV2.loadCommissions().then(() => {
                    console.log('‚úÖ Commission data loaded successfully');
                    
                    // Update admin interface if available
                    if (window.commissionAdminV2) {
                        window.commissionAdminV2.renderCommissions();
                        window.commissionAdminV2.updateStats();
                    }
                    
                    // Debug info for troubleshooting
                    const commissions = window.commissionSystemV2.getAllCommissions();
                    const publicCommissions = window.commissionSystemV2.getPublicCommissions();
                    
                    console.log('üìä Commission data loaded:', {
                        total: commissions.length,
                        public: publicCommissions.length,
                        firebaseReady: window.commissionSystemV2.firebaseReady,
                        commissions: commissions.map(c => ({
                            id: c.id,
                            title: c.title,
                            artist: c.artist,
                            isPublic: c.isPublic,
                            status: c.status
                        }))
                    });
                    
                    // Restore button
                    button.innerHTML = originalText;
                    button.disabled = false;
                    
                    // Show detailed results
                    const message = `‚úÖ Data loaded!\n\n` +
                                  `Total Commissions: ${commissions.length}\n` +
                                  `Public Commissions: ${publicCommissions.length}\n` +
                                  `Firebase Status: ${window.commissionSystemV2.firebaseReady ? 'Connected' : 'Disconnected'}\n\n` +
                                  `Recent Commissions:\n` +
                                  commissions.slice(0, 5).map(c => `‚Ä¢ ${c.title || c.artist || 'Untitled'}`).join('\n');
                    
                    alert(message);
                }).catch((error) => {
                    console.error('‚ùå Error loading commission data:', error);
                    
                    // Restore button
                    button.innerHTML = originalText;
                    button.disabled = false;
                    
                    alert('‚ùå Error loading commission data: ' + error.message);
                });
            } catch (error) {
                console.error('‚ùå Error in force load:', error);
                alert('‚ùå Error: ' + error.message);
            }
        } else {
            alert('‚ùå Commission system not initialized yet. Please wait a moment and try again.');
        }
    }
    
    function refreshData() {
        if (!window.commissionSystemV2) {
            alert('‚ùå Commission system not initialized yet. Please wait a moment and try again.');
            return;
        }
        
        const button = document.getElementById('refresh-data');
        const originalText = button.innerHTML;
        
        try {
            console.log('üîÑ Refreshing all data...');
            button.innerHTML = '‚è≥ Refreshing...';
            button.disabled = true;
            
            // Force reinitialize both commissions and future artists
            Promise.all([
                window.commissionSystemV2.loadCommissions(),
                window.commissionSystemV2.loadFutureArtists()
            ]).then(() => {
                // Update UI
                if (window.commissionAdminV2) {
                    window.commissionAdminV2.renderCommissions();
                    window.commissionAdminV2.updateStats();
                }
                
                button.innerHTML = originalText;
                button.disabled = false;
                
                const commissions = window.commissionSystemV2.getAllCommissions();
                const futureArtists = window.commissionSystemV2.getFutureArtists();
                
                const message = `‚úÖ All data refreshed successfully!\n\n` +
                              `Commissions: ${commissions.length}\n` +
                              `Future Artists: ${futureArtists.length}\n` +
                              `Firebase Status: ${window.commissionSystemV2.firebaseReady ? 'Connected' : 'Disconnected'}`;
                
                alert(message);
            }).catch((error) => {
                console.error('‚ùå Error refreshing data:', error);
                button.innerHTML = originalText;
                button.disabled = false;
                alert('‚ùå Error refreshing data: ' + error.message);
            });
        } catch (error) {
            console.error('‚ùå Error in refresh:', error);
            button.innerHTML = originalText;
            button.disabled = false;
            alert('‚ùå Error: ' + error.message);
        }
    }
    
    function debugSystem() {
        console.log('üîç System Debug Information:');
        
        const debugInfo = {
            firebaseCommissionSystemAvailable: !!window.FirebaseCommissionSystem,
            commissionSystemV2Available: !!window.commissionSystemV2,
            commissionAdminV2Available: !!window.commissionAdminV2,
            firebaseReady: window.commissionSystemV2 ? window.commissionSystemV2.firebaseReady : 'N/A',
            commissionsCount: window.commissionSystemV2 ? window.commissionSystemV2.getAllCommissions().length : 'N/A',
            publicCommissionsCount: window.commissionSystemV2 ? window.commissionSystemV2.getPublicCommissions().length : 'N/A',
            futureArtistsCount: window.commissionSystemV2 ? window.commissionSystemV2.getFutureArtists().length : 'N/A',
            publicFutureArtistsCount: window.commissionSystemV2 ? window.commissionSystemV2.getPublicFutureArtists().length : 'N/A'
        };
        
        console.table(debugInfo);
        
        let message = 'üîç System Debug Information:\n\n';
        Object.entries(debugInfo).forEach(([key, value]) => {
            message += `${key}: ${value}\n`;
        });
        
        if (window.commissionSystemV2 && window.commissionSystemV2.getAllCommissions().length > 0) {
            const commissions = window.commissionSystemV2.getAllCommissions();
            message += `\nüìã Sample Commissions:\n`;
            commissions.slice(0, 3).forEach(c => {
                message += `‚Ä¢ ${c.title || c.artist || 'Untitled'} (${c.status || 'unknown'})\n`;
            });
        }
        
        if (window.commissionSystemV2 && window.commissionSystemV2.getFutureArtists().length > 0) {
            const artists = window.commissionSystemV2.getFutureArtists();
            message += `\nüé® Sample Future Artists:\n`;
            artists.slice(0, 3).forEach(a => {
                message += `‚Ä¢ ${a.artistName || 'Unnamed'} (${a.status || 'unknown'})\n`;
            });
        }
        
        alert(message);
    }
    
    // Future Artists Management System
    let futureArtistsSystem;

    // Make these functions global so onclick handlers can access them
    window.showFutureArtistForm = function() {
        document.getElementById('future-artist-modal').style.display = 'flex';
    }

    window.hideFutureArtistForm = function() {
        document.getElementById('future-artist-modal').style.display = 'none';
        document.getElementById('future-artist-form').reset();
    }

    window.viewFutureArtists = function() {
        document.getElementById('future-artists-list-modal').style.display = 'flex';
        loadFutureArtistsList();
    }

    window.hideFutureArtistsList = function() {
        document.getElementById('future-artists-list-modal').style.display = 'none';
    }

    window.exportFutureArtists = async function() {
        if (!window.commissionSystemV2 || !window.commissionSystemV2.getFutureArtists) {
            alert('‚ùå No future artists data available');
            return;
        }
        
        const artists = window.commissionSystemV2.getFutureArtists();
        const data = {
            exportDate: new Date().toISOString(),
            totalArtists: artists.length,
            artists: artists
        };
        
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `future-artists-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
        
        alert('‚úÖ Future artists data exported successfully!');
    }

    window.editFutureArtist = function(artistId) {
        alert('‚úèÔ∏è Edit functionality coming soon! For now, you can delete and re-add the artist.');
    }

    window.deleteFutureArtist = async function(artistId) {
        if (!window.commissionSystemV2) {
            alert('‚ùå System not ready');
            return;
        }
        
        const artist = window.commissionSystemV2.getFutureArtistById(artistId);
        if (!artist) {
            alert('‚ùå Artist not found');
            return;
        }
        
        if (confirm(`Are you sure you want to delete "${artist.artistName}" from your future artists list?`)) {
            try {
                const success = await window.commissionSystemV2.deleteFutureArtist(artistId);
                
                if (success) {
                    loadFutureArtistsList();
                    alert('‚úÖ Artist deleted successfully!');
                } else {
                    alert('‚ùå Failed to delete artist');
                }
            } catch (error) {
                console.error('‚ùå Error deleting artist:', error);
                alert('‚ùå Error deleting artist: ' + error.message);
            }
        }
    }

    async function initFutureArtistsSystem() {
        if (!window.commissionSystemV2) return;
        
        // Add future artists functionality to the commission system
        window.commissionSystemV2.futureArtists = [];
        
        // Future Artists Firebase functions
        window.commissionSystemV2.addFutureArtist = async function(artistData) {
            if (!this.firebaseReady) return false;
            
            try {
                const artistId = this.generateArtistId();
                const docRef = this.firestore.doc(this.db, 'futureArtists', artistId);
                await this.firestore.setDoc(docRef, {
                    ...artistData,
                    id: artistId,
                    dateAdded: new Date().toISOString()
                });
                
                console.log('üé® Future artist added:', artistData.artistName);
                await this.loadFutureArtists();
                return true;
            } catch (error) {
                console.error('‚ùå Error adding future artist:', error);
                return false;
            }
        };
        
        window.commissionSystemV2.loadFutureArtists = async function() {
            if (!this.firebaseReady) return;
            
            try {
                const artistsRef = this.firestore.collection(this.db, 'futureArtists');
                const q = this.firestore.query(artistsRef, this.firestore.orderBy('dateAdded', 'desc'));
                const querySnapshot = await this.firestore.getDocs(q);
                
                this.futureArtists = [];
                querySnapshot.forEach((doc) => {
                    this.futureArtists.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });
                
                console.log(`üé® Loaded ${this.futureArtists.length} future artists`);
            } catch (error) {
                console.error('‚ùå Error loading future artists:', error);
            }
        };
        
        window.commissionSystemV2.getPublicFutureArtists = function() {
            return this.futureArtists.filter(artist => artist.isPublic !== false);
        };
        
        window.commissionSystemV2.generateArtistId = function() {
            const timestamp = Date.now();
            const random = Math.floor(Math.random() * 1000);
            return `ARTIST-${timestamp}-${random}`;
        };
        
        // Load existing artists
        await window.commissionSystemV2.loadFutureArtists();
    }

    async function handleFutureArtistSubmit(e) {
        e.preventDefault();
        
        if (!window.commissionSystemV2) {
            alert('‚ùå System not ready. Please try again.');
            return;
        }
        
        const formData = new FormData(e.target);
        const artistData = {
            artistName: formData.get('artistName'),
            platform: formData.get('platform'),
            handle: formData.get('handle'),
            website: formData.get('website'),
            style: formData.get('style'),
            commissionType: formData.get('commissionType'),
            estimatedCost: formData.get('estimatedCost'),
            priority: formData.get('priority'),
            notes: formData.get('notes'),
            status: formData.get('status'),
            isPublic: formData.has('isPublic')
        };
        
        const success = await window.commissionSystemV2.addFutureArtist(artistData);
        
        if (success) {
            alert('‚úÖ Future artist added successfully!');
            hideFutureArtistForm();
            // Refresh the list if it's currently open
            if (document.getElementById('future-artists-list-modal').style.display === 'flex') {
                loadFutureArtistsList();
            }
        } else {
            alert('‚ùå Failed to add future artist. Please try again.');
        }
    }

    function loadFutureArtistsList() {
        const container = document.getElementById('future-artists-container');
        if (!container || !window.commissionSystemV2) {
            console.warn('‚ö†Ô∏è Future artists container or system not available');
            return;
        }
        
        const artists = window.commissionSystemV2.getFutureArtists() || [];
        console.log(`üé® Loading ${artists.length} future artists`);
        
        if (artists.length === 0) {
            container.innerHTML = `
                <div class="no-future-artists">
                    <h3>üé® No Future Artists</h3>
                    <p>No artists have been added to your future commission list yet.</p>
                    <p><small>Use "Refresh Data" above to reload from the database.</small></p>
                </div>
            `;
            return;
        }
        
        const artistsHTML = artists.map(artist => `
            <div class="future-artist-card">
                <div class="artist-header">
                    <h3 class="artist-name">${escapeHtml(artist.artistName)}</h3>
                    <div class="artist-priority priority-${artist.priority}">
                        ${formatPriority(artist.priority)}
                    </div>
                </div>
                
                <div class="artist-details">
                    ${artist.platform ? `
                    <div class="artist-detail">
                        <span class="label">Platform:</span>
                        <span class="value">${escapeHtml(artist.platform)}</span>
                    </div>
                    ` : ''}
                    
                    ${artist.handle ? `
                    <div class="artist-detail">
                        <span class="label">Handle:</span>
                        <span class="value">${escapeHtml(artist.handle)}</span>
                    </div>
                    ` : ''}
                    
                    ${artist.website ? `
                    <div class="artist-detail">
                        <span class="label">Portfolio:</span>
                        <span class="value"><a href="${escapeHtml(artist.website)}" target="_blank">View Portfolio</a></span>
                    </div>
                    ` : ''}
                    
                    ${artist.style ? `
                    <div class="artist-detail">
                        <span class="label">Style:</span>
                        <span class="value">${escapeHtml(artist.style)}</span>
                    </div>
                    ` : ''}
                    
                    ${artist.commissionType ? `
                    <div class="artist-detail">
                        <span class="label">Commission Type:</span>
                        <span class="value">${escapeHtml(artist.commissionType)}</span>
                    </div>
                    ` : ''}
                    
                    ${artist.estimatedCost ? `
                    <div class="artist-detail">
                        <span class="label">Estimated Cost:</span>
                        <span class="value">${escapeHtml(artist.estimatedCost)}</span>
                    </div>
                    ` : ''}
                    
                    <div class="artist-detail">
                        <span class="label">Status:</span>
                        <span class="value">
                            <span class="artist-status status-${artist.status}">
                                ${formatArtistStatus(artist.status)}
                            </span>
                        </span>
                    </div>
                    
                    <div class="artist-detail">
                        <span class="label">Visibility:</span>
                        <span class="value">${artist.isPublic ? 'üëÅÔ∏è Public' : 'üîí Private'}</span>
                    </div>
                </div>
                
                ${artist.notes ? `
                <div class="artist-notes">
                    <p>${escapeHtml(artist.notes)}</p>
                </div>
                ` : ''}
                
                <div class="artist-actions">
                    <button onclick="editFutureArtist('${artist.id}')" class="btn-edit">
                        ‚úèÔ∏è Edit
                    </button>
                    <button onclick="deleteFutureArtist('${artist.id}')" class="btn-delete">
                        üóëÔ∏è Delete
                    </button>
                    ${artist.website ? `
                    <button onclick="window.open('${escapeHtml(artist.website)}', '_blank')" class="btn-secondary">
                        üåê Portfolio
                    </button>
                    ` : ''}
                </div>
            </div>
        `).join('');
        
        container.innerHTML = artistsHTML;
    }

    function formatPriority(priority) {
        const priorityMap = {
            'high': 'üî• High Priority',
            'medium': '‚≠ê Medium Priority',
            'low': 'üìã Low Priority',
            'someday': 'üí§ Someday'
        };
        return priorityMap[priority] || priority;
    }

    function formatArtistStatus(status) {
        const statusMap = {
            'researching': 'üîç Researching',
            'planning': 'üìã Planning',
            'ready': '‚úÖ Ready to Commission',
            'contacted': 'üìß Contacted',
            'commissioned': 'üé® Commissioned'
        };
        return statusMap[status] || status;
    }

    async function exportFutureArtists() {
        if (!window.commissionSystemV2 || !window.commissionSystemV2.futureArtists) {
            alert('‚ùå No future artists data available');
            return;
        }
        
        const data = {
            exportDate: new Date().toISOString(),
            totalArtists: window.commissionSystemV2.futureArtists.length,
            artists: window.commissionSystemV2.futureArtists
        };
        
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `future-artists-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
        
        alert('‚úÖ Future artists data exported successfully!');
    }

    function escapeHtml(text) {
        if (!text) return '';
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    // Add form submit listener for future artists
    document.addEventListener('DOMContentLoaded', function() {
        const futureArtistForm = document.getElementById('future-artist-form');
        if (futureArtistForm) {
            futureArtistForm.addEventListener('submit', handleFutureArtistSubmit);
        }
    });
    
    function testPrideTheme() {
        // Load and activate pride theme
        if (window.PrideMonthSpecial) {
            try {
                const prideSystem = new window.PrideMonthSpecial();
                prideSystem.forceActivate();
                updateThemeStatus('Pride Month Special', 'Rainbow animations, pride ticker');
            } catch (error) {
                console.error('Pride theme error:', error);
                applyFallbackPrideTheme();
            }
        } else {
            applyFallbackPrideTheme();
        }
        
        alert('üè≥Ô∏è‚Äçüåà Pride Theme activated! Rainbow power engaged!');
    }
    
    function applyFallbackPrideTheme() {
        // Don't remove existing themes, just add pride theme
        const existingStyle = document.getElementById('test-pride-theme');
        if (existingStyle) existingStyle.remove();
        
        // Fallback: apply basic pride styling - EXCLUDING theme test section
        const style = document.createElement('style');
        style.id = 'test-pride-theme';
        style.textContent = `
            body:not(.theme-test-section):not(.theme-test-section *) {
                background: linear-gradient(45deg, #e40303 0%, #ff8c00 16%, #ffed00 32%, #008018 48%, #004cff 64%, #732982 80%) !important;
                animation: prideShimmer 3s ease-in-out infinite alternate;
            }
            @keyframes prideShimmer {
                0% { filter: brightness(1); }
                100% { filter: brightness(1.2); }
            }
            .site-header:not(.theme-test-section):not(.theme-test-section *) { 
                background: rgba(0,0,0,0.8) !important; 
                border-bottom: 2px solid #ff69b4;
            }
            .admin-container > *:not(.theme-test-section) h1,
            .admin-container > *:not(.theme-test-section) h2, 
            .admin-container > *:not(.theme-test-section) h3 { 
                background: linear-gradient(45deg, #e40303, #ff8c00, #ffed00, #008018, #004cff, #732982) !important;
                background-clip: text !important;
                -webkit-background-clip: text !important;
                -webkit-text-fill-color: transparent !important;
                background-size: 200% 200% !important;
                animation: rainbowText 2s ease-in-out infinite alternate !important;
            }
            @keyframes rainbowText {
                0% { background-position: 0% 50%; }
                100% { background-position: 100% 50%; }
            }
            /* ABSOLUTE PROTECTION for theme test section */
            .theme-test-section,
            .theme-test-section *,
            .theme-test-section .theme-test-btn {
                background: initial !important;
                color: initial !important;
                animation: none !important;
                background-clip: initial !important;
                -webkit-background-clip: initial !important;
                -webkit-text-fill-color: initial !important;
                filter: none !important;
                transform: none !important;
                display: initial !important;
                visibility: visible !important;
                opacity: 1 !important;
                z-index: 999999 !important;
            }
        `;
        document.head.appendChild(style);
        updateThemeStatus('Pride Theme (Basic)', 'Pride colors active');
    }
    
    function testTransTheme() {
        // Load and activate trans awareness theme
        if (window.TransAwarenessSpecial) {
            try {
                const transSystem = new window.TransAwarenessSpecial();
                transSystem.forceActivate();
                updateThemeStatus('Trans Awareness Special', 'Trans pride colors, special ticker');
            } catch (error) {
                console.error('Trans theme error:', error);
                applyFallbackTransTheme();
            }
        } else {
            applyFallbackTransTheme();
        }
        
        alert('üè≥Ô∏è‚Äç‚ößÔ∏è Trans Theme activated! Trans pride colors engaged!');
    }
    
    function applyFallbackTransTheme() {
        // Don't remove existing themes, just add trans theme
        const existingStyle = document.getElementById('test-trans-theme');
        if (existingStyle) existingStyle.remove();
        
        // Fallback: apply basic trans styling - EXCLUDING theme test section
        const style = document.createElement('style');
        style.id = 'test-trans-theme';
        style.textContent = `
            .admin-container:not(.theme-test-section) { 
                background: linear-gradient(45deg, rgba(85, 205, 252, 0.3), rgba(247, 168, 184, 0.3), rgba(255, 255, 255, 0.3)) !important;
                border: 2px solid #55cdfc;
            }
            .stats-section .stat-card { 
                border-color: #55cdfc !important; 
                background: linear-gradient(135deg, rgba(85, 205, 252, 0.2), rgba(247, 168, 184, 0.2)) !important;
            }
            .password-card { border-color: #55cdfc !important; }
            .commission-form-container, .commission-controls, .commission-list { 
                background: rgba(85, 205, 252, 0.1) !important;
                border-color: #55cdfc !important;
            }
            /* ABSOLUTE PROTECTION for theme test section */
            .theme-test-section,
            .theme-test-section *,
            .theme-test-section .theme-test-btn {
                background: initial !important;
                border-color: initial !important;
                color: initial !important;
                animation: none !important;
                filter: none !important;
                transform: none !important;
                display: initial !important;
                visibility: visible !important;
                opacity: 1 !important;
                z-index: 999999 !important;
            }
        `;
        document.head.appendChild(style);
        updateThemeStatus('Trans Theme (Basic)', 'Trans pride colors active');
    }
    
    function testEarthTheme() {
        // Load and activate earth day theme
        if (window.EarthDaySpecial) {
            try {
                const earthSystem = new window.EarthDaySpecial();
                earthSystem.forceActivate();
                updateThemeStatus('Earth Day Special', 'Green theme, plant animations, EVE overlay');
            } catch (error) {
                console.error('Earth theme error:', error);
                applyFallbackEarthTheme();
            }
        } else {
            applyFallbackEarthTheme();
        }
        
        alert('üåç Earth Day Theme activated! Going green!');
    }
    
    function applyFallbackEarthTheme() {
        // Don't remove existing themes, just add earth theme
        const existingStyle = document.getElementById('test-earth-theme');
        if (existingStyle) existingStyle.remove();
        
        // Fallback: apply basic earth styling - EXCLUDING theme test section
        const style = document.createElement('style');
        style.id = 'test-earth-theme';
        style.textContent = `
            .admin-container:not(.theme-test-section) { 
                background: linear-gradient(135deg, rgba(27, 94, 32, 0.8), rgba(46, 125, 50, 0.8), rgba(56, 142, 60, 0.8)) !important;
                border: 2px solid #4caf50;
            }
            .commission-form-container, .commission-controls, .commission-list { 
                background: rgba(27, 94, 32, 0.6) !important;
                border-color: #4caf50 !important;
            }
            .stats-section .stat-card { 
                border-color: #4caf50 !important; 
                background: linear-gradient(135deg, rgba(76, 175, 80, 0.3), rgba(139, 195, 74, 0.3)) !important;
            }
            .password-card { border-color: #4caf50 !important; }
            .admin-section:not(.theme-test-section) { border-color: #4caf50 !important; }
            /* ABSOLUTE PROTECTION for theme test section */
            .theme-test-section,
            .theme-test-section *,
            .theme-test-section .theme-test-btn {
                background: initial !important;
                border-color: initial !important;
                color: initial !important;
                animation: none !important;
                filter: none !important;
                transform: none !important;
                display: initial !important;
                visibility: visible !important;
                opacity: 1 !important;
                z-index: 999999 !important;
            }
        `;
        document.head.appendChild(style);
        updateThemeStatus('Earth Day Theme (Basic)', 'Green theme active');
    }
    
    function removeTestThemes() {
        const testStyles = ['test-pride-theme', 'test-trans-theme', 'test-earth-theme'];
        testStyles.forEach(id => {
            const style = document.getElementById(id);
            if (style) style.remove();
        });
    }
    
    function resetToDefault() {
        // Remove all test themes
        removeTestThemes();
        
        // Deactivate special systems if they exist
        try {
            if (window.prideMonthSpecial) {
                window.prideMonthSpecial.deactivate();
            }
            if (window.transAwarenessSpecial) {
                window.transAwarenessSpecial.deactivate();
            }
            if (window.earthDaySpecial) {
                window.earthDaySpecial.deactivate();
            }
        } catch (error) {
            console.log('No special systems to deactivate:', error);
        }
        
        // Reset to default dark theme
        if (window.themeManager) {
            window.themeManager.applyTheme('dark');
        } else {
            document.documentElement.setAttribute('data-theme', 'dark');
        }
        
        updateThemeStatus('Dark (Default)', 'None Active');
        
        alert('üîÑ Theme reset to default dark mode!');
    }
    
    function updateThemeStatus(themeName = null, effects = null, dbStatus = null) {
        const activeThemeElement = document.getElementById('active-theme');
        const effectsElement = document.getElementById('special-effects-status');
        const timeElement = document.getElementById('theme-change-time');
        const dbStatusElement = document.getElementById('database-status');
        
        if (activeThemeElement && themeName) {
            activeThemeElement.textContent = themeName;
        }
        
        if (effectsElement && effects !== null) {
            effectsElement.textContent = effects;
        }
        
        if (timeElement) {
            timeElement.textContent = new Date().toLocaleTimeString();
        }
        
        if (dbStatusElement && dbStatus !== null) {
            dbStatusElement.textContent = dbStatus;
        }
    }
    
    // Initialize theme test system
    setTimeout(() => {
        initThemeTestSystem();
        
        // Add debug logging for theme buttons
        console.log('üé® Theme test system initialized');
        console.log('Theme buttons found:', {
            'dark': !!document.getElementById('test-dark-theme'),
            'pride': !!document.getElementById('test-pride-theme'),
            'trans': !!document.getElementById('test-trans-theme'),
            'earth': !!document.getElementById('test-earth-theme'),
            'reset': !!document.getElementById('reset-theme'),
            'load-data': !!document.getElementById('force-load-data')
        });
    }, 500);
    
    // Copy button functionality
    document.querySelectorAll('.copy-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const textToCopy = this.getAttribute('data-copy');
            navigator.clipboard.writeText(textToCopy).then(() => {
                if (typeof customDialogs !== 'undefined') {
                    customDialogs.alert('Copied to clipboard: ' + textToCopy);
                } else {
                    alert('Copied to clipboard: ' + textToCopy);
                }
            }).catch(() => {
                alert('Failed to copy to clipboard');
            });
        });
    });

    // Data Management Functions
    const exportBtn = document.getElementById('export-rankings');
    const clearBtn = document.getElementById('clear-rankings');
    
    if (exportBtn) {
        exportBtn.addEventListener('click', function() {
            const rankings = localStorage.getItem('characterRankings');
            if (rankings) {
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(rankings);
                const downloadAnchorNode = document.createElement('a');
                downloadAnchorNode.setAttribute("href", dataStr);
                downloadAnchorNode.setAttribute("download", "axiom_rankings_" + new Date().toISOString().split('T')[0] + ".json");
                document.body.appendChild(downloadAnchorNode);
                downloadAnchorNode.click();
                downloadAnchorNode.remove();
                
                alert('Rankings data exported successfully!');
            } else {
                alert('No rankings data found to export.');
            }
        });
    }
    
    if (clearBtn) {
        clearBtn.addEventListener('click', function() {
            if (confirm('Are you sure you want to clear all character rankings data? This action cannot be undone.')) {
                localStorage.removeItem('characterRankings');
                alert('All rankings data has been cleared.');
            }
        });
    }
});
</script>

<script src="../js/firebase-commission-system.js"></script>
<script src="../js/commission-admin-v2.js"></script>
<script src="../js/custom-dialogs.js"></script>
<script src="../js/nav-dropdowns.js"></script>
<script src="../js/shiptime.js"></script>
<script src="../js/theme-toggle.js"></script>
<script src="../js/pride-month-special.js"></script>
<script src="../js/trans-awareness-special.js"></script>
<script src="../js/earth-day-special.js"></script>

</body>
</html>
